<html>
<head>
        <script type="text/javascript" src="lib/pptcreator.js"> </script>
        <script type="text/javascript" src="lib/jszip.min.js"></script>
    <script type="text/javascript">
             
             const pptTemplate = 'assets/job_info.pptx';
                
                const getObjects = () => {
                  return [{varName : "Bob", varInfo: "Amarelo e quadrado", varJob : "JellyFish Hunter", varDescription : "The protagonist, man of the show. Sounds like Goku sometimes.", imgData : [{name: "Image",  path : "images/bob.jpg" }] },
                    {varName : "Patrick", varInfo: "Rosa e estrela", varJob : "Smart Friend", varDescription : "Super Friend, smart and reliable", imgData : [{name: "Image", path : "images/patrick.png"}] },
                    {varName : "Sandy", varInfo: "Astronauta", varJob : "Friend from surface", varDescription : "like guns ( probably).", imgData : [{name: "Image", path : "images/sandy.png"}] }];                   
                }

                const generateAndDownload = () => {
                    // Set the common Image (logo) and the object data
                    let objs = { imgData: [{name: 'Logo', path: 'images/logo.png'}],
                                 data : getObjects()};
                    let pptx = new Presentation();
                    pptx.loadAndProcess(objs, pptTemplate).then(() => { pptx.downloadBuffer() });

                }

    </script>
</head>
<body>
    <img src="images/logo.png" height="140" />
<div> <p> Export all users to PPT </p>
     <input type="button" value="Export PPT" onclick="generateAndDownload()" /> </div>
</body>
</html>